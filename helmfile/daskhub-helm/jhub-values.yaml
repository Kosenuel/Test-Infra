hub:
  db:
    type: sqlite-pvc
    pvc:
      storageClassName: csi-cinder-sc-delete
      accessModes: [ReadWriteOnce]
      storage: 1Gi

  config:
    JupyterHub:
      authenticator_class: generic-oauth
    GenericOAuthenticator:
      client_id: "<from-secret>"
      client_secret: "<from-secret>"
      oauth_callback_url: "https://protocoast.vm.fedcloud.eu/hub/oauth_callback"
      authorize_url: "https://aai-demo.egi.eu/auth/realms/egi/protocol/openid-connect/auth"
      token_url: "https://aai-demo.egi.eu/auth/realms/egi/protocol/openid-connect/token"
      userdata_url: "https://aai-demo.egi.eu/auth/realms/egi/protocol/openid-connect/userinfo"
      scope: [openid, profile, email, entitlements]
      username_key: preferred_username
      allow_all: true

  extraConfig:
    protocoast-profiles: |
      c.KubeSpawner.extra_resource_guarantees = {"ephemeral-storage": "4Gi"}
      c.KubeSpawner.extra_resource_limits = {"ephemeral-storage": "8Gi"}
      c.KubeSpawner.profile_list = [
        {'display_name':'ProtoCoast - main','slug':'protocoast-main','default':True,'kubespawner_override':{'image':'quay.io/globalcoast/protocoast-notebook:main'}},
        {'display_name':'ProtoCoast - develop','slug':'protocoast-develop','kubespawner_override':{'image':'quay.io/globalcoast/protocoast-notebook:develop'}}
      ]

  services:
    dask-gateway:
      display: false
      apiToken: some-token-for-dask-gateway-to-talk-to-jupyterhub

proxy:
  service:
    type: ClusterIP
  https:
    enabled: false

ingress:
  enabled: true
  ingressClassName: nginx
  annotations:
    # kubernetes.io/ingress.class: nginx
    cert-manager.io/cluster-issuer: letsencrypt-prod
    nginx.ingress.kubernetes.io/ssl-redirect: "true"
    nginx.ingress.kubernetes.io/proxy-body-size: "100m"
  hosts: [protocoast.vm.fedcloud.eu]
  tls:
    - hosts: [protocoast.vm.fedcloud.eu]
      secretName: protocoast-tls

singleuser:
  image:
    name: quay.io/globalcoast/protocoast-notebook
    tag: main
  memory:
    limit: "10G"
    guarantee: "5G"
  cpu:
    limit: 2
    guarantee: 1
  storage:
    type: dynamic
    dynamic:
      storageClass: csi-cinder-sc-delete
    capacity: 50Gi
  networkPolicy:
    enabled: false

prePuller:
  hook:
    enabled: false
  continuous:
    enabled: true

scheduling:
  userScheduler:
    enabled: false
  podPriority:
    enabled: true
  userPlaceholder:
    enabled: false
